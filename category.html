<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Category Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-gray-100 to-gray-200 min-h-screen p-6">

  <div class="max-w-5xl mx-auto space-y-12">

    <!-- Section 1: Add New Category -->
    <section class="bg-white rounded-2xl shadow-2xl p-8">
      <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Add New Category</h2>

      <form id="categoryForm" class="grid grid-cols-1 gap-6">
        <div>
          <label class="block text-gray-700 font-medium mb-2">Category Name</label>
          <input type="text" id="categoryName" class="w-full p-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-400 focus:outline-none" placeholder="Enter category name" required>
        </div>

       <!-- Buttons -->
<div class="flex justify-center gap-4 mt-6">
  <button type="submit" class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-xl font-semibold shadow-md transition">
    Save Category
  </button>
  <button type="reset" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-3 rounded-xl font-semibold shadow-md transition">
    Reset
  </button>
  <button type="button" onclick="window.location.href='admin.html'" class="bg-gray-400 hover:bg-gray-500 text-white px-6 py-3 rounded-xl font-semibold shadow-md transition">
    ‚Üê Back
  </button>
</div>
      </form>
    </section>

    <!-- Section 2: Current Categories -->
    <section class="bg-white rounded-2xl shadow-2xl p-8">
      <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Current Categories</h2>
      <div id="categoryList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
    </section>

  </div>

  <script>
    // Categories are now stored as an array of objects: [{name: 'CategoryName'}]
    let categories = JSON.parse(localStorage.getItem('categories') || '[]');
    const categoryListDiv = document.getElementById('categoryList');
    const categoryForm = document.getElementById('categoryForm');

    function renderCategories() {
      categoryListDiv.innerHTML = '';
      if (categories.length === 0) {
        categoryListDiv.innerHTML = '<p class="text-gray-500 text-center">No categories added yet.</p>';
        return;
      }

      categories.forEach((cat, index) => {
        const card = document.createElement('div');
        card.className = 'bg-gray-50 rounded-xl shadow p-4 flex justify-between items-center';
        
        // The comment is now outside the backticks and will be ignored correctly.
        card.innerHTML = `
          <span class="font-semibold text-gray-700">${cat.name}</span>
          <div class="flex gap-2">
            <button class="bg-yellow-500 text-white px-3 py-1 rounded-lg hover:bg-yellow-600" onclick="editCategory(${index})">Edit</button>
            <button class="bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600" onclick="deleteCategory(${index})">Delete</button>
          </div>
        `;
        categoryListDiv.appendChild(card);
      });
    }

    function editCategory(index) {
      // Use cat.name to get the name for editing
      document.getElementById('categoryName').value = categories[index].name;
      categoryForm.dataset.editIndex = index;
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function deleteCategory(index) {
      const categoryNameToDelete = categories[index].name;
      if (confirm(`Are you sure you want to delete "${categoryNameToDelete}"?`)) {
        categories.splice(index, 1);
        localStorage.setItem('categories', JSON.stringify(categories));
        renderCategories();
      }
    }

    categoryForm.addEventListener('submit', e => {
      e.preventDefault();
      const nameInput = document.getElementById('categoryName').value.trim();
      if (!nameInput) return;

      const editIndex = categoryForm.dataset.editIndex;

      if (editIndex !== undefined && editIndex !== '') {
        // Update the name property of the existing object
        categories[editIndex].name = nameInput;
        categoryForm.removeAttribute('data-edit-index');
      } else {
        // Check if a category with this name already exists
        if (categories.some(cat => cat.name.toLowerCase() === nameInput.toLowerCase())) {
          alert('Category already exists!');
          return;
        }
        // Push a new object to the array
        categories.push({ name: nameInput });
      }

      localStorage.setItem('categories', JSON.stringify(categories));
      categoryForm.reset();
      renderCategories();
    });

    renderCategories();
  </script>

</body>
</html>
