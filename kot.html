<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compact KOT</title>
<style>
    body { font-family: monospace; white-space: pre; text-align: left; font-size: 12px; }
    .kot { border: 1px dashed #000; padding: 6px; width: 180px; }
    .header, .footer { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 4px; }
    th, td { padding: 1px 0; }
    th { border-bottom: 1px dashed #000; text-align: left; }
    td.right { text-align: right; }
    hr { border: 0; border-top: 1px dashed #000; margin: 3px 0; }
</style>
</head>
<body>

<div class="kot" id="kot">
    <div class="header">
        <strong id="shopName">My Shop Name</strong>
    </div>
    <hr>
    Table: <span id="tableNo"></span><br>
    Invoice: <span id="invoiceNo"></span><br>
    Date & Time: <span id="dateTime"></span>
    <hr>
    <table>
        <thead>
            <tr>
                <th>Item</th>
                <th class="right">Qty</th>
            </tr>
        </thead>
        <tbody id="kotItems"></tbody>
    </table>
    <hr>
    <div class="footer">--- KOT ---</div>
</div>

<script>
const orderData = JSON.parse(localStorage.getItem('currentPrintOrder')) || {};
const kotOrder = orderData.items || [];
const tableNo = orderData.table || '1';

// Keep invoice number same as receipt
let lastInvoice = parseInt(localStorage.getItem('lastInvoice') || 1000);
const invoiceNo = '#' + lastInvoice;

const dateTime = new Date().toLocaleString();

// Fill header
document.getElementById('tableNo').innerText = tableNo;
document.getElementById('invoiceNo').innerText = invoiceNo;
document.getElementById('dateTime').innerText = dateTime;
document.getElementById('shopName').innerText = localStorage.getItem('shopName') || 'My Shop Name';

// Fill items
const kotItems = document.getElementById('kotItems');
kotItems.innerHTML = '';
kotOrder.forEach(item => {
    const row = document.createElement('tr');
    row.innerHTML = `<td>${item.name}</td><td class="right">${item.qty}</td>`;
    kotItems.appendChild(row);
});

// Optional: auto-print for thermal printer
// window.print();
</script>

</body>
</html>
