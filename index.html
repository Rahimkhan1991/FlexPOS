<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restaurant POS System</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f2f2f2;
    }
    .header {
      background: #ffffff;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .content {
      display: flex;
      height: calc(100vh - 60px);
    }
    .categories, .items, .cart {
      padding: 15px;
      overflow-y: auto;
    }
    .categories {
      width: 20%;
      background: #ffffff;
      border-right: 1px solid #ccc;
    }
    .items {
      width: 50%;
      background: #ffffff;
      border-right: 1px solid #ccc;
    }
    .cart {
      width: 30%;
      background: #ffffff;
    }
    .category-btn, .item-btn {
      display: block;
      width: 100%;
      padding: 10px;
      margin-bottom: 8px;
      background: #e0e0e0;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
    .item-btn {
      background: #d9edf7;
    }
    .cart-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      padding: 8px;
      background: #f9f9f9;
      border: 1px solid #ddd;
    }
    .cart-total {
      font-weight: bold;
      font-size: 18px;
      padding-top: 10px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h2>Restaurant POS</h2>
    <span id="user-info"></span>
  </div>
  <div class="content">
    <div class="categories" id="categories"></div>
    <div class="items" id="items"></div>
    <div class="cart">
 <!-- Inside the .cart div -->
<h3>Cart</h3>
<div id="cart-items"></div>
<div class="cart-total" id="cart-total">Total: Rp0</div>
<button onclick="submitOrder()">Submit Order</button>

    </div>
  </div>

  <script>
    const itemsData = JSON.parse(localStorage.getItem('items')) || [];
    const categoriesData = JSON.parse(localStorage.getItem('categories')) || [];
    const currentUser = JSON.parse(localStorage.getItem('currentUser')) || { name: 'Sales' };

    document.getElementById('user-info').textContent = `User: ${currentUser.name}`;

    const cart = [];

    function renderCategories() {
      const catDiv = document.getElementById('categories');
      catDiv.innerHTML = '';
      categoriesData.forEach(cat => {
        const btn = document.createElement('button');
        btn.className = 'category-btn';
        btn.textContent = cat.name;
        btn.onclick = () => renderItems(cat.name);
        catDiv.appendChild(btn);
      });
    }

    function renderItems(categoryName) {
      const itemsDiv = document.getElementById('items');
      itemsDiv.innerHTML = '';
      itemsData.filter(i => i.category === categoryName).forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'item-btn';
        btn.textContent = `${item.name} - Rp${item.price}`;
        btn.onclick = () => addToCart(item);
        itemsDiv.appendChild(btn);
      });
    }

    function addToCart(item) {
      const existing = cart.find(c => c.name === item.name);
      if (existing) {
        existing.qty++;
      } else {
        cart.push({ ...item, qty: 1 });
      }
      updateCartDisplay();
    }

    function updateCartDisplay() {
      const cartDiv = document.getElementById('cart-items');
      cartDiv.innerHTML = '';
      let total = 0;
      cart.forEach(c => {
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.textContent = `${c.qty} x ${c.name} = Rp${c.qty * c.price}`;
        cartDiv.appendChild(div);
        total += c.qty * c.price;
      });
      document.getElementById('cart-total').textContent = `Total: Rp${total}`;
    function submitOrder() {
  if (cart.length === 0) {
    alert("Cart is empty!");
    return;
  }

  const tableName = prompt("Enter Table Name:");
  if (!tableName) return;

  const now = new Date();
  const order = {
    id: Date.now(),
    user: currentUser.name,
    table: tableName,
    timestamp: now.toISOString(),
    items: [...cart],
    kitchenOrders: {},
  };

  // Group items by kitchen
  itemsData.forEach(item => {
    if (!order.kitchenOrders[item.kitchen]) {
      order.kitchenOrders[item.kitchen] = [];
    }
    const found = cart.find(ci => ci.name === item.name);
    if (found) {
      order.kitchenOrders[item.kitchen].push({ name: found.name, qty: found.qty });
    }
  });

  // Save to localStorage
  const orders = JSON.parse(localStorage.getItem('orders') || '[]');
  orders.push(order);
  localStorage.setItem('orders', JSON.stringify(orders));

  alert("Order submitted!");
  cart.length = 0;
  updateCartDisplay();
}

    }

    renderCategories();
  </script>
</body>
</html>
