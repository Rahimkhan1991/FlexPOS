<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Restaurant POS</title>
  <style>
    body { margin: 0; font-family: sans-serif; background: #f2f2f2; }
    .header { background: #fff; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .content { display: flex; height: calc(100vh - 60px); }
    .categories, .items, .cart { padding: 15px; overflow-y: auto; }
    .categories { width: 20%; background: #fff; border-right: 1px solid #ccc; }
    .items { width: 50%; background: #fff; border-right: 1px solid #ccc; }
    .cart { width: 30%; background: #fff; }
    .category-btn, .item-btn { display: block; width: 100%; padding: 10px; margin-bottom: 8px; border: none; cursor: pointer; font-size: 16px; }
    .category-btn { background: #e0e0e0; }
    .item-btn { background: #d9edf7; }
    .cart-item { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 8px; background: #f9f9f9; border: 1px solid #ddd; }
    .cart-total { font-weight: bold; font-size: 18px; padding-top: 10px; }
  </style>
</head>
<body>
  <div class="header">
    <h2>Restaurant POS</h2>
    <span id="user-info"></span>
  </div>

  <div class="content">
    <div class="categories" id="categories"></div>
    <div class="items" id="items"></div>
    <div class="cart">
      <h3>Cart</h3>
      <div id="cart-items"></div>
      <div class="cart-total" id="cart-total">Total: Rp0</div>
    </div>
  </div>

  <script>
    // Check login
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    if (!currentUser) {
      window.location.href = "index.html";
    }
    document.getElementById("user-info").textContent = `User: ${currentUser.username} (${currentUser.role})`;

    // Sample Data (Later replace with data.js or backend)
    const categories = ["Makanan", "Minuman"];
    const items = [
      { name: "Nasi Goreng", price: 20000, category: "Makanan" },
      { name: "Ayam Bakar", price: 25000, category: "Makanan" },
      { name: "Es Teh", price: 5000, category: "Minuman" },
      { name: "Jus Alpukat", price: 10000, category: "Minuman" }
    ];

    const cart = [];

    function renderCategories() {
      const catDiv = document.getElementById('categories');
      catDiv.innerHTML = '';
      categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.className = 'category-btn';
        btn.textContent = cat;
        btn.onclick = () => renderItems(cat);
        catDiv.appendChild(btn);
      });
    }

    function renderItems(category) {
      const itemsDiv = document.getElementById('items');
      itemsDiv.innerHTML = '';
      items.filter(i => i.category === category).forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'item-btn';
        btn.textContent = `${item.name} - Rp${item.price}`;
        btn.onclick = () => addToCart(item);
        itemsDiv.appendChild(btn);
      });
    }

    function addToCart(item) {
      const existing = cart.find(c => c.name === item.name);
      if (existing) {
        existing.qty++;
      } else {
        cart.push({ ...item, qty: 1 });
      }
      updateCart();
    }

    function updateCart() {
      const cartDiv = document.getElementById('cart-items');
      cartDiv.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.textContent = `${item.qty} x ${item.name} = Rp${item.qty * item.price}`;
        cartDiv.appendChild(div);
        total += item.qty * item.price;
      });
      document.getElementById('cart-total').textContent = `Total: Rp${total}`;
    }

    renderCategories();
  </script>
</body>
</html>
